<div class="row">

  <div *ngIf="error">
    {{error}}
  </div>

  <div *ngIf="isLoading; else appointmentsCard">
    <mat-progress-spinner mode="indeterminate">
    </mat-progress-spinner>
  </div>

  <ng-template #appointmentsCard>
    <div class="row">
      <div fxFlex="100" fxFlex.sm="49">

        <mat-form-field>
          <mat-label>Name</mat-label>
          <input (ngModelChange)="updateNameOfEvent()" [(ngModel)]="name" matInput placeholder="Your name">
          <mat-hint>At least 6 characters</mat-hint>
        </mat-form-field>

        <br>

        <mat-form-field>
          <mat-label>Timezones</mat-label>
          <mat-select (valueChange)="timezoneChanged($event)" [(value)]="selectedTimezone">
            <mat-option [value]="null">Your timezone</mat-option>
            <mat-option *ngFor="let timezone of timezones" [value]="timezone">{{timezone}}</mat-option>
          </mat-select>
        </mat-form-field>

        <div>
          <button (click)="bookAppointment()" [disabled]="!canBook()" mat-button>Book</button>
          <button (click)="loadData()" mat-button>Refresh</button>
        </div>

      </div>
      <div fxFlex="100" fxFlex.sm="49">
        <div class="row">
          <div class="col-md-6">
            <div class="btn-group">
              <div
                [(viewDate)]="viewDate"
                [view]="'day'"
                class="btn btn-primary"
                mwlCalendarPreviousView
              >
                Previous
              </div>
              <div
                [(viewDate)]="viewDate"
                class="btn btn-outline-secondary"
                mwlCalendarToday
              >
                Today
              </div>
              <div
                [(viewDate)]="viewDate"
                [view]="'day'"
                class="btn btn-primary"
                mwlCalendarNextView
              >
                Next
              </div>
            </div>
          </div>
          <div class="col-md-6 text-right">
            <h3>{{ viewDate | calendarDate:('dayViewTitle') }}</h3>
          </div>
        </div>
        <br/>

        <ng-template
          #dayViewHourSegmentTemplate
          let-isTimeLabel="isTimeLabel"
          let-locale="locale"
          let-segment="segment"
          let-segmentHeight="segmentHeight"
        >
          <div
            #segmentElement
            (mousedown)="startDragToCreate(segment, $event, segmentElement)"
            [class.cal-after-hour-start]="!segment.isStart"
            [class.cal-hour-start]="segment.isStart"
            [ngClass]="segment.cssClass"
            [style.height.px]="segmentHeight"
            class="cal-hour-segment"
          >
            <div *ngIf="isTimeLabel" class="cal-time">
              {{ segment.date | calendarDate:'dayViewHour':locale }}
            </div>
          </div>
        </ng-template>


        <ng-template
          #marker
        >
        </ng-template>

        <mwl-calendar-day-view
          [currentTimeMarkerTemplate]="marker"
          [dayEndHour]="getEndHour()"
          [dayEndMinute]="getEndMinute()"
          [dayStartHour]="getStartHour()"
          [dayStartMinute]="getStartMinute()"
          [events]="events"
          [hourSegmentTemplate]="dayViewHourSegmentTemplate"
          [hourSegments]="4"
          [viewDate]="viewDate"
        >
        </mwl-calendar-day-view>

      </div>
    </div>

  </ng-template>

</div>
